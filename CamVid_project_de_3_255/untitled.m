% Base reference date
base_date = datetime(2015,09,10);

% Visa Bulletin Dates (actual Visa Bulletin publish months)
vb_dates = datetime([...
    2015 09 10; 2015 10 10; 2015 11 10; 2015 12 10; ...
    2016 01 10; 2016 02 10; 2016 03 10; 2016 04 10; ...
    2016 05 10; 2016 06 10; 2016 07 10; 2016 08 10; ...
    2016 09 10; 2016 10 10; 2016 11 10; 2016 12 10; ...
    2017 01 10; 2017 02 10; 2017 03 10; 2017 04 10; ...
    2017 05 10; 2017 06 10; 2017 07 10; 2017 08 10; ...
    2017 09 10; 2017 10 10; 2017 11 10; 2017 12 10; ...
    2018 01 10; 2018 02 10; 2018 03 10; 2018 04 10; ...
    2018 05 10; 2018 06 10; 2018 07 10; 2018 08 10; ...
    2018 09 10; 2018 10 10; 2018 11 10; 2018 12 10; ...
    2019 01 10; 2019 02 10; 2019 03 10; 2019 04 10; ...
    2019 05 10; 2019 06 10; 2019 07 10; 2019 08 10; ...
    2019 09 10; 2019 10 10; 2019 11 10; 2019 12 10; ...
    2020 01 10; 2020 02 10; 2020 03 10; 2020 04 10; ...
    2020 05 10; 2020 06 10; 2020 07 10; 2020 08 10; ...
    2020 09 10; 2020 10 10; 2020 11 10; 2020 12 10; ...
    2021 01 10; 2021 02 10; 2021 03 10; 2021 04 10; ...
    2021 05 10; 2021 06 10; 2021 07 10; 2021 08 10; ...
    2021 09 10; 2021 10 10; 2021 11 10; 2021 12 10; ...
    2022 01 10; 2022 02 10; 2022 03 10; 2022 04 10; ...
    2022 05 10; 2022 06 10; 2022 07 10; 2022 08 10; ...
    2022 09 10; 2022 10 10; 2022 11 10; 2022 12 10; ...
    2023 01 10; 2023 02 10; 2023 03 10; 2023 04 10; ...
    2023 05 10; 2023 06 10; 2023 07 10; 2023 08 10; ...
    2023 09 10; 2023 10 10; 2023 11 10; 2023 12 10; ...
    2024 01 10; 2024 02 10; 2024 03 10; 2024 04 10; ...
    2024 05 10; 2024 06 10; 2024 07 10; 2024 08 10; ...
    2024 09 10; 2024 10 10; 2024 11 10; 2024 12 10; ...
    2025 01 10; 2025 02 10; 2025 03 10; 2025 04 10; ...
    ]);

% Final Action Dates (PDs processed as of each VB month)
fad = datetime([...
    2015 09 10; 2015 10 10; 2015 11 10; 2015 12 10; ...
    2016 01 10; 2016 02 10; 2016 03 10; 2016 04 10; ...
    2016 05 10; 2016 06 10; 2016 07 10; 2014 02 01; ...
    2014 02 01; 2016 10 10; 2016 11 10; 2016 12 10; ...
    2017 01 10; 2017 02 10; 2017 03 10; 2017 04 10; ...
    2017 05 10; 2017 06 10; 2017 07 10; 2015 04 01; ...
    2016 01 01; 2017 10 10; 2017 11 10; 2017 12 10; ...
    2018 01 10; 2018 02 10; 2018 03 10; 2018 04 10; ...
    2018 05 10; 2018 06 10; 2018 07 10; 2018 08 10; ...
    2013 01 01; 2018 10 10; 2018 11 10; 2018 12 10; ...
    2019 01 10; 2019 02 10; 2019 03 10; 2019 04 10; ...
    2019 05 10; 2019 06 10; 2019 07 10; 2017 01 01; ...
    2018 01 01; 2019 10 10; 2019 11 10; 2019 12 10; ...
    2020 01 10; 2020 02 10; 2020 03 10; 2020 04 10; ...
    2020 05 10; 2020 06 10; 2020 07 10; 2020 08 10; ...
    2020 09 10; 2020 10 10; 2020 11 10; 2020 12 10; ...
    2021 01 10; 2021 02 10; 2021 03 10; 2021 04 10; ...
    2021 05 10; 2021 06 10; 2021 07 10; 2021 08 10; ...
    2021 09 10; 2021 10 10; 2021 11 10; 2021 12 10; ...
    2022 01 10; 2022 02 10; 2022 03 10; 2022 04 10; ...
    2022 05 10; 2022 06 10; 2022 07 10; 2022 08 10; ...
    2022 09 10; 2022 10 10; 2022 11 10; 2022 12 01; ...
    2022 12 01; 2022 12 01; 2022 12 01; 2022 07 01; ...
    2022 02 15; 2022 02 15; 2022 02 15; 2022 04 01; ...
    2022 07 01; 2023 01 01; 2023 01 01; 2023 01 01; ...
    2023 02 15; 2022 11 22; 2023 01 15; 2023 01 15; ...
    2023 01 15; 2023 01 15; 2023 03 15; 2023 03 15; ...
    2023 03 15; 2023 08 01; 2023 08 01; 2023 08 01; ...
    2023 08 01; 2023 04 01; 2023 05 15; 2023 06 22; ...
    ]);

% Convert both VB and FAD to days since base date
x = days(vb_dates - base_date);  % X-axis: visa bulletin dates
y = days(fad - base_date);       % Y-axis: final action dates

% Plot
figure;
plot(x, y, 'b-o', 'LineWidth', 2, 'DisplayName', 'Final Action Date');
hold on;

% Plot y = x line for comparison
plot(x, x, 'k--', 'LineWidth', 1.5, 'DisplayName', 'y = x (Current)');

% Axis formatting
xticks(x);  % Set x-ticks to visa bulletin dates
xticklabels(datestr(vb_dates, 'mmm-yyyy'));  % Use original order
xtickangle(45);  % Rotate x-tick labels

yticks(unique(y));  % Use only unique FAD ticks
yticklabels(datestr(unique(fad), 'mmm-yyyy'));  % Corresponding labels

xlabel('Visa Bulletin Date');
ylabel('Final Action Date');
title('EB2 ROW: Final Action Date vs Visa Bulletin Date');
legend('Location', 'NorthWest');

grid on;
axis equal;

